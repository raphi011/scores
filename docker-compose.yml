version: "3.6"

services:
  frontend:
    image: raphi011/scores-frontend
    build:
      context: .
      dockerfile: ./web/Dockerfile
    ports:
      - "127.0.0.1:3000:3000"

  backend:
    image: raphi011/scores-backend
    build:
      context: .
      dockerfile: ./cmd/api/Dockerfile
    environment:
      - GIN_MODE=release
      - BACKEND_URL=https://scores.network
      - APP_ENV=production

    ports:
      - "127.0.0.1:8080:8080"
    volumes:
      - "~/data/api:/srv/scores"

  # deactivate it for now
  # scrape:
  #   image: raphi011/scores-scrape
  #   depends_on:
  #     - "backend"
  #   build:
  #     context: .
  #     dockerfile: ./cmd/terminal/Dockerfile

  db:
    image: mariadb:latest
    volumes:
      - "~/data/mariadb:/var/lib/mysql"
    ports:
      - "3306:3306"
    environment:
      - MYSQL_ROOT_PASSWORD=test
